<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Comparison - UPLC Benchmark</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">UPLC Benchmark</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="comparison"><a class="header" href="#comparison">Comparison</a></h1>
<p>While trying to implement all validators as closely to each other as possible there are some differences that impact measured script size and execution units.</p>
<ul>
<li>Plutarch while decoding Data-encoded types is checking for invariants such as hashes lengths, map key ordering etc. which leads to higher start up cost visible in NFT Marketplace validator.</li>
<li>Opshin does expose option to compile without tracing so that is included in the final size. All implementations use traces in their source code but remaining allow to strip it with a compilation flag.</li>
<li>Note that opshin validators are not benchmarked currently as they do not support PlutusV3 yet. They will be restored when they will support it. We have decided to migrate to V3 as Aiken cannot target older Plutus versions.</li>
</ul>
<h2 id="versions"><a class="header" href="#versions">Versions</a></h2>
<!-- versions.md -->
<ul>
<li>plutus-tx: 1.40.0.0</li>
<li>plutarch: 1.10.1</li>
<li>aiken: v1.1.15+unknown</li>
<li>opshin: 0.24.1</li>
</ul>
<h2 id="script-size-bytes"><a class="header" href="#script-size-bytes">Script size (bytes)</a></h2>
<p>Script sizes are compared by compiling each script to CBOR and taking its binary size in bytes. Validators are compiled without traces if language supports it (Opshin does not) and are not passed through any external UPLC optimizer.</p>
<p><img src="./script_size.png" alt="size plot" /></p>
<!-- script_size.md -->
<div class="table-wrapper"><table><thead><tr><th>Language</th><th>lp-minting-policy.bin</th><th>nft-marketplace-validator.bin</th><th>nft-minting-policy.bin</th><th>pool-validator.bin</th></tr></thead><tbody>
<tr><td>Plutarch</td><td>320</td><td>350</td><td>406</td><td>1081</td></tr>
<tr><td>Aiken</td><td>485</td><td>386</td><td>399</td><td>1502</td></tr>
<tr><td>PlutusTx</td><td>2938</td><td>4333</td><td>3204</td><td>4330</td></tr>
</tbody></table>
</div>
<p><a href="./script_size.csv">Raw script size data</a></p>
<h2 id="execution-units"><a class="header" href="#execution-units">Execution Units</a></h2>
<p>Execution units are abstract units of CEK machine. Despite being called CPU and Memory they <em>DO NOT</em> mean CPU cycles or allocated bytes, these are abstract, deterministic units of the virtual machine that executes UPLC.</p>
<h3 id="lp-policy---mint-one"><a class="header" href="#lp-policy---mint-one">LP Policy - mint one</a></h3>
<p><img src="./budget_lp_mint_one_nft.png" alt="execution_units plot" /></p>
<!-- budget_lp_mint_one_nft.md -->
<div class="table-wrapper"><table><thead><tr><th>Language</th><th>CPU</th><th>Memory</th></tr></thead><tbody>
<tr><td>Plutarch</td><td>17797661</td><td>47962</td></tr>
<tr><td>Aiken</td><td>17366314</td><td>56974</td></tr>
<tr><td>PlutusTx</td><td>65739767</td><td>276544</td></tr>
</tbody></table>
</div>
<p><a href="./budget_lp_mint_one_nft.csv">Raw execution units data</a></p>
<h3 id="lp-policy---mint-two"><a class="header" href="#lp-policy---mint-two">LP Policy - mint two</a></h3>
<p><img src="./budget_lp_mint_two_nfts.png" alt="execution_units plot" /></p>
<!-- budget_lp_mint_two_nfts.md -->
<div class="table-wrapper"><table><thead><tr><th>Language</th><th>CPU</th><th>Memory</th></tr></thead><tbody>
<tr><td>Plutarch</td><td>31018976</td><td>79485</td></tr>
<tr><td>Aiken</td><td>28936338</td><td>94149</td></tr>
<tr><td>PlutusTx</td><td>76000836</td><td>323156</td></tr>
</tbody></table>
</div>
<p><a href="./budget_lp_mint_two_nfts.csv">Raw execution units data</a></p>
<h3 id="pool-nft-policy---mint"><a class="header" href="#pool-nft-policy---mint">Pool NFT Policy - mint</a></h3>
<p><img src="./budget_nft_mint.png" alt="execution_units plot" /></p>
<!-- budget_nft_mint.md -->
<div class="table-wrapper"><table><thead><tr><th>Language</th><th>CPU</th><th>Memory</th></tr></thead><tbody>
<tr><td>Plutarch</td><td>15299441</td><td>40575</td></tr>
<tr><td>Aiken</td><td>14923802</td><td>38363</td></tr>
<tr><td>PlutusTx</td><td>63511332</td><td>269611</td></tr>
</tbody></table>
</div>
<p><a href="./budget_nft_mint.csv">Raw execution units data</a></p>
<h3 id="pool-validator---swap-a-for-b"><a class="header" href="#pool-validator---swap-a-for-b">Pool Validator - swap A for B</a></h3>
<p><img src="./budget_swap_a_for_b.png" alt="execution_units plot" /></p>
<!-- budget_swap_a_for_b.md -->
<div class="table-wrapper"><table><thead><tr><th>Language</th><th>CPU</th><th>Memory</th></tr></thead><tbody>
<tr><td>Plutarch</td><td>101745804</td><td>230523</td></tr>
<tr><td>Aiken</td><td>79768207</td><td>234780</td></tr>
<tr><td>PlutusTx</td><td>296827268</td><td>1371798</td></tr>
</tbody></table>
</div>
<p><a href="./budget_swap_a_for_b.csv">Raw execution units data</a></p>
<h3 id="pool-validator---swap-b-for-a"><a class="header" href="#pool-validator---swap-b-for-a">Pool Validator - swap B for A</a></h3>
<p><img src="./budget_swap_b_for_a.png" alt="execution_units plot" /></p>
<!-- budget_swap_b_for_a.md -->
<div class="table-wrapper"><table><thead><tr><th>Language</th><th>CPU</th><th>Memory</th></tr></thead><tbody>
<tr><td>Plutarch</td><td>101745804</td><td>230523</td></tr>
<tr><td>Aiken</td><td>79768207</td><td>234780</td></tr>
<tr><td>PlutusTx</td><td>296827268</td><td>1371798</td></tr>
</tbody></table>
</div>
<p><a href="./budget_swap_b_for_a.csv">Raw execution units data</a></p>
<h3 id="pool-validator---deposit"><a class="header" href="#pool-validator---deposit">Pool Validator - deposit</a></h3>
<p><img src="./budget_deposit.png" alt="execution_units plot" /></p>
<!-- budget_deposit.md -->
<div class="table-wrapper"><table><thead><tr><th>Language</th><th>CPU</th><th>Memory</th></tr></thead><tbody>
<tr><td>Plutarch</td><td>102846505</td><td>230681</td></tr>
<tr><td>Aiken</td><td>81975434</td><td>241842</td></tr>
<tr><td>PlutusTx</td><td>328569786</td><td>1521400</td></tr>
</tbody></table>
</div>
<p><a href="./budget_deposit.csv">Raw execution units data</a></p>
<h3 id="pool-validator---withdraw"><a class="header" href="#pool-validator---withdraw">Pool Validator - withdraw</a></h3>
<p><img src="./budget_withdraw.png" alt="execution_units plot" /></p>
<!-- budget_withdraw.md -->
<div class="table-wrapper"><table><thead><tr><th>Language</th><th>CPU</th><th>Memory</th></tr></thead><tbody>
<tr><td>Plutarch</td><td>103150887</td><td>231783</td></tr>
<tr><td>Aiken</td><td>82279816</td><td>242944</td></tr>
<tr><td>PlutusTx</td><td>328939621</td><td>1522902</td></tr>
</tbody></table>
</div>
<p><a href="./budget_withdraw.csv">Raw execution units data</a></p>
<h3 id="nft-marketplace---buy-one"><a class="header" href="#nft-marketplace---buy-one">NFT Marketplace - buy one</a></h3>
<p><img src="./budget_buy_one.png" alt="execution_units plot" /></p>
<!-- budget_buy_one.md -->
<div class="table-wrapper"><table><thead><tr><th>Language</th><th>CPU</th><th>Memory</th></tr></thead><tbody>
<tr><td>Plutarch</td><td>13525181</td><td>32227</td></tr>
<tr><td>Aiken</td><td>13389768</td><td>28583</td></tr>
<tr><td>PlutusTx</td><td>334948111</td><td>1379416</td></tr>
</tbody></table>
</div>
<p><a href="./budget_buy_one.csv">Raw execution units data</a></p>
<h3 id="nft-marketplace---cancel-one"><a class="header" href="#nft-marketplace---cancel-one">NFT Marketplace - cancel one</a></h3>
<p><img src="./budget_cancel_one.png" alt="execution_units plot" /></p>
<!-- budget_cancel_one.md -->
<div class="table-wrapper"><table><thead><tr><th>Language</th><th>CPU</th><th>Memory</th></tr></thead><tbody>
<tr><td>Plutarch</td><td>8216257</td><td>24229</td></tr>
<tr><td>Aiken</td><td>7142519</td><td>22591</td></tr>
<tr><td>PlutusTx</td><td>138764847</td><td>579120</td></tr>
</tbody></table>
</div>
<p><a href="./budget_cancel_one.csv">Raw execution units data</a></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="specifications.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="specifications.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
